<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CafÃ© de Tere - Social Media Analytics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <style>
        :root {
            --color-primary: #BDC730;
            --color-secondary: #DEE398;
            --color-background: #FFFFFF;
            --color-accent: #AED1B8;
            --color-dark-accent: #5DA271;
            --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--color-background);
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .header {
            background-color: var(--color-dark-accent);
            color: var(--color-background);
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .container {
            padding: 20px;
            max-width: 1400px;
            margin: auto;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background-color: var(--color-secondary);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card h2 {
            margin-top: 0;
            color: var(--color-dark-accent);
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .metric p {
            margin: 5px 0;
            font-size: 1.1em;
        }

        .metric strong {
            color: var(--color-primary);
            font-size: 1.2em;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
        }

        th, td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--color-accent);
        }

        th {
            background-color: var(--color-primary);
            color: var(--color-background);
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: var(--color-secondary);
        }

        tr:hover {
            background-color: var(--color-accent);
        }

        /* Specific styles for the Topics and Conclusion section */
        .topics-conclusion {
            grid-column: 1 / -1;
        }

        .topic-item {
            border: 1px solid var(--color-primary);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            background-color: var(--color-background);
        }

        .topic-item h3 {
            color: var(--color-dark-accent);
            margin-top: 0;
        }

        .topic-item p:first-of-type {
            font-weight: bold;
        }

        .conclusion-box {
            background-color: var(--color-primary);
            color: #333;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .conclusion-box h3 {
            color: var(--color-background);
            margin-top: 0;
            border-bottom: 2px solid var(--color-background);
            padding-bottom: 5px;
        }

        .conclusion-box ol {
            padding-left: 20px;
        }

        .conclusion-box li {
            margin-bottom: 5px;
            color: var(--color-background);
        }
    </style>
</head>
<body>

<div class="header">
    <h1>CafÃ© de Tere - Social Media Analytics Dashboard ðŸ“Š</h1>
    <p>Data-driven insights for strategic decision-making.</p>
</div>

<div class="container">

    <div class="grid">
        <div class="card metric">
            <h2>Key Social Metrics Overview</h2>
            <p>Total Posts Analyzed: <strong>1199</strong></p>
            <p>Average Favorite Count: <strong>12.20</strong></p>
            <p>Average Retweet Count: <strong>33.93</strong></p>
            <p>Mean User Followers: <strong>5,046</strong> (Std Dev: 72,793)</p>
            <p>Max Favorite Count: <strong>2,733</strong></p>
            <p>Max Retweet Count: <strong>28,090</strong></p>
        </div>
        <div class="card">
            <h2>Correlation: Followers vs. Engagement</h2>
            <p>Followers count has a **moderate positive correlation** with **Favorite Count** ($\mathbf{r = 0.37}$) .</p>
            <p>Followers count has a **low positive correlation** with **Retweet Count** ($\mathbf{r = 0.13}$).</p>
            <p>This suggests that while high follower counts somewhat boost engagement, other factors significantly drive Retweets.</p>
            <p>Friend Count vs. Followers: $\mathbf{r = 0.58}$ (Moderate-strong correlation).</p>
        </div>
        <div class="card" style="grid-column: span 2;">
            <h2>Top 10 High-Engagement Tweets (Total Engagement Score)</h2>
            <div class="table-container">
                <table id="top-tweets-table">
                    <thead>
                        <tr>
                            <th>Tweet Excerpt</th>
                            <th>Favorites</th>
                            <th>Retweets</th>
                            <th>Engagement Score</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="grid">
        <div class="card" style="grid-column: 1 / -1;">
            <h2>Engagement Heatmap: Activity by Day and Hour (Count)</h2>
            <p><em>The chart visualizes tweet count, where -1 indicates no data/zero activity for that specific hour.</em></p>
            <canvas id="engagementHeatmapChart"></canvas>
        </div>
    </div>

    <div class="grid topics-conclusion">
        <div class="card">
            <h2>Key Business Topics & Challenges</h2>
            <div id="topics-list">
                </div>
            
            <div class="conclusion-box">
                <h3>Final Conclusion & Tactical Priorities ðŸŽ¯</h3>
                <p>The brand is **iconic** but operates in a **polarised** environment. Friction points are price/value, product consistency, payment methods, and operational experience.</p>
                <h4>Top Priorities:</h4>
                <ol>
                    <li>**Habilitar pagos con tarjeta/QR** (Enable card/QR payments) to reduce friction.</li>
                    <li>**Recalibrar y estandarizar recetas** (Recalibrate and standardize recipes), especially for *tigrillo* and *bolÃ³n*, controlling temperature and salt.</li>
                    <li>**Ajustar la propuesta de valor** (Adjust the value proposition): portions, combos, and delivery/ajÃ­ policies.</li>
                    <li>**Fortalecer el discurso de inclusiÃ³n y emprendimiento** (Strengthen the discourse of inclusion and entrepreneurship) with empathetic responses.</li>
                    <li>**Capitalizar la viralidad** (Capitalize on virality) with channel-specific activations and offers.</li>
                </ol>
            </div>
        </div>
    </div>

</div>

<script>
    const data = {"describe_matrix": {"count": {"favorite_count": 1198.0, "id": 1199.0, "retweet_count": 1198.0, "user.followers_count": 1198.0, "user.friends_count": 1198.0}, "mean": {"favorite_count": 12.202003338898164, "id": 1.1909482828284088e+18, "retweet_count": 33.925709515859765, "user.followers_count": 5046.368948247078, "user.friends_count": 1021.626878130217}, "std": {"favorite_count": 104.53245995361105, "id": 3.4425044120617452e+16, "retweet_count": 815.0630495614117, "user.followers_count": 72793.23507864912, "user.friends_count": 6446.56499792927}, "min": {"favorite_count": 0.0, "id": 167.0, "retweet_count": 0.0, "user.followers_count": 1.0, "user.friends_count": 0.0}, "25%": {"favorite_count": 0.0, "id": 1.1918218393786122e+18, "retweet_count": 0.0, "user.followers_count": 186.5, "user.friends_count": 262.0}, "50%": {"favorite_count": 0.0, "id": 1.191929775016874e+18, "retweet_count": 0.0, "user.followers_count": 483.0, "user.friends_count": 532.5}, "75%": {"favorite_count": 2.0, "id": 1.192133212113404e+18, "retweet_count": 1.0, "user.followers_count": 1377.25, "user.friends_count": 992.75}, "max": {"favorite_count": 2733.0, "id": 1.192608404327547e+18, "retweet_count": 28090.0, "user.followers_count": 1997889.0, "user.friends_count": 221536.0}}, "corr_matrix": {"user.followers_count": {"user.followers_count": 1.0, "user.friends_count": 0.5770596319321523, "id": -0.14474055631145605, "favorite_count": 0.3743598815158741, "retweet_count": 0.1283469079000893}, "user.friends_count": {"user.followers_count": 0.5770596319321523, "user.friends_count": 1.0, "id": -0.09306009552025668, "favorite_count": 0.16383723344715007, "retweet_count": 0.05420889555106655}, "id": {"user.followers_count": -0.14474055631145605, "user.friends_count": -0.09306009552025668, "id": 1.0, "favorite_count": -0.1278758415977603, "retweet_count": 0.07590999064439975}, "favorite_count": {"user.followers_count": 0.3743598815158741, "user.friends_count": 0.16383723344715007, "id": -0.1278758415977603, "favorite_count": 1.0, "retweet_count": 0.1210178774154952}, "retweet_count": {"user.followers_count": 0.1283469079000893, "user.friends_count": 0.05420889555106655, "id": 0.07590999064439975, "favorite_count": 0.1210178774154952, "retweet_count": 1.0}}, "engagement_matrix": {"text": {"33": "@Cesar_Antonio_F @LivePalestina @Jou_Kaiser @tere_marinovic @elvillegaschile @sergioulloa1 @German69738375\u2026 https://t.co/0mgrQNJVrU", "3276": "@dearc26 @eluniversocom Q insoportable estas personas resentidas. Viven amargados! Hay gustos y gustos. El bol\u00f3n de Tere es rico!", "3738": "Se acab\u00f3 el chisme con el #closetdedav y ahora leo twists del #cafedetere... qu\u00e9 tiro guayaquile\u00f1os todo bien en casa?", "2198": "@KaritoSoBsc Oe oe oe bien recuerdo que una vez twitteaste qu\u00e9 m\u00e1s barato Te sal\u00eda comprar un departamento en salin\u2026 https://t.co/FL0MGZv9Hx", "1951": "La se\u00f1ora del caf\u00e9 d Tere es la prueba de q trabajando duro se puede llegar a rico. Ella ha demostrado q no es nece\u2026 https://t.co/JMNbFy5KLS", "3608": "Cuando trabajaba en el parque Col\u00f3n una vez quise ir al #cafedetere que hay ah\u00ed vi los precios y me parecieron dema\u2026 https://t.co/LP8o8NIHU6", "3992": "@ornella_soriano @_SantinoBoy @CafedeTere Que comentario tan regionalista... cabeza hueca que piensa que en la sier\u2026 https://t.co/cWBukqR7EM", "3457": "@tere_marinovic En esta crisis, no hay buenos ni malos, se enfrentan entre chilenos, padres y familias. Y todo este\u2026 https://t.co/CQsnaeEs8Z", "2148": "Si el cafe de tere te parece que es caro, turro y puro mkt anda busca otro bolon chtm\nEl ecuatoriano pr\u00f3spero tiene\u2026 https://t.co/APCz649NbZ", "932": "Soy cliente regular del Caf\u00e9 de Tere. Ahora bien, que siga sin aceptar tarjetas de cr\u00e9dito es indefendible. Do\u00f1a Te\u2026 https://t.co/jHdbRXcdfa"}, "favorite_count": {"33": 10.0, "3276": 79.0, "3738": 10.0, "2198": 46.0, "1951": 332.0, "3608": 1.0, "3992": 1.0, "3457": 7.0, "2148": 187.0, "932": 130.0}, "retweet_count": {"33": 1.0, "3276": 1.0, "3738": 3.0, "2198": 3.0, "1951": 81.0, "3608": 0.0, "3992": 0.0, "3457": 3.0, "2148": 63.0, "932": 35.0}, "total_engagement": {"33": 250.0, "3276": 86.81318681318682, "3738": 66.66666666666666, "2198": 63.888888888888886, "1951": 61.141804788213626, "3608": 33.33333333333333, "3992": 33.33333333333333, "3457": 19.444444444444446, "2148": 15.583333333333332, "932": 13.30603889457523}}, "heatmap": {"Monday": {"0.0": -1.0, "1.0": 0.0, "2.0": -1.0, "3.0": 0.0, "4.0": -1.0, "5.0": -1.0, "6.0": -1.0, "7.0": 0.0, "8.0": -1.0, "9.0": 0.0, "10.0": -1.0, "11.0": 0.0, "12.0": -1.0, "13.0": -1.0, "14.0": 1.0, "15.0": 1.0, "16.0": 3.0, "17.0": 177.0, "18.0": -1.0, "19.0": -1.0, "20.0": -1.0, "21.0": -1.0, "22.0": 2734.0, "23.0": 82.0}, "Tuesday": {"0.0": 1.0, "1.0": 32.0, "2.0": 20.0, "3.0": 0.0, "4.0": 3.0, "5.0": -1.0, "6.0": -1.0, "7.0": 1.0, "8.0": -1.0, "9.0": 0.0, "10.0": -1.0, "11.0": 1.0, "12.0": 3.0, "13.0": 73.0, "14.0": 195.0, "15.0": 18.0, "16.0": 175.0, "17.0": 102.0, "18.0": 1012.0, "19.0": 651.0, "20.0": 210.0, "21.0": 412.0, "22.0": 1555.0, "23.0": 1331.0}, "Wednesday": {"0.0": 209.0, "1.0": 906.0, "2.0": 1789.0, "3.0": 895.0, "4.0": 265.0, "5.0": 37.0, "6.0": 27.0, "7.0": 31.0, "8.0": 37.0, "9.0": 4.0, "10.0": 12.0, "11.0": 64.0, "12.0": 46.0, "13.0": 115.0, "14.0": 98.0, "15.0": 76.0, "16.0": 36.0, "17.0": 160.0, "18.0": 24.0, "19.0": 34.0, "20.0": 22.0, "21.0": 282.0, "22.0": 65.0, "23.0": 83.0}, "Thursday": {"0.0": 37.0, "1.0": 104.0, "2.0": 40.0, "3.0": 10.0, "4.0": 15.0, "5.0": 8.0, "6.0": 0.0, "7.0": 0.0, "8.0": -1.0, "9.0": 0.0, "10.0": 0.0, "11.0": 1.0, "12.0": 17.0, "13.0": 5.0, "14.0": 1.0, "15.0": 3.0, "16.0": 57.0, "17.0": 29.0, "18.0": 10.0, "19.0": 1.0, "20.0": 16.0, "21.0": 1.0, "22.0": 1.0, "23.0": 100.0}, "Friday": {"0.0": 5.0, "1.0": 0.0, "2.0": -1.0, "3.0": -1.0, "4.0": -1.0, "5.0": -1.0, "6.0": -1.0, "7.0": -1.0, "8.0": -1.0, "9.0": -1.0, "10.0": -1.0, "11.0": -1.0, "12.0": -1.0, "13.0": -1.0, "14.0": 8.0, "15.0": -1.0, "16.0": -1.0, "17.0": -1.0, "18.0": -1.0, "19.0": -1.0, "20.0": -1.0, "21.0": -1.0, "22.0": -1.0, "23.0": -1.0}, "Saturday": {"0.0": 5.0, "1.0": -1.0, "2.0": -1.0, "3.0": -1.0, "4.0": -1.0, "5.0": -1.0, "6.0": -1.0, "7.0": -1.0, "8.0": -1.0, "9.0": -1.0, "10.0": 11.0, "11.0": -1.0, "12.0": -1.0, "13.0": 0.0, "14.0": 0.0, "15.0": 5.0, "16.0": 2.0, "17.0": 8.0, "18.0": -1.0, "19.0": -1.0, "20.0": -1.0, "21.0": 0.0, "22.0": -1.0, "23.0": -1.0}, "Sunday": {"0.0": -1.0, "1.0": 0.0, "2.0": -1.0, "3.0": -1.0, "4.0": -1.0, "5.0": -1.0, "6.0": -1.0, "7.0": -1.0, "8.0": -1.0, "9.0": -1.0, "10.0": -1.0, "11.0": -1.0, "12.0": -1.0, "13.0": 7.0, "14.0": -1.0, "15.0": 0.0, "16.0": 0.0, "17.0": -1.0, "18.0": 1.0, "19.0": -1.0, "20.0": -1.0, "21.0": -1.0, "22.0": 0.0, "23.0": -1.0}}, "topics": {"topics": [{"title": "Precio y percepci\u00f3n de valor", "detail": "Fuerte polarizaci\u00f3n: para muchos es \u201ccaro/sobrevalorado\u201d (bol\u00f3n $3,5\u2013$5, jugos hasta $8, extras como huevo $1, m\u00ednimos de delivery altos); otros justifican que se paga limpieza, local, marca y servicio.", "challenge": "Definir estrategia de precios y porciones (combos, tama\u00f1os, \u201cbol\u00f3n popular\u201d en franjas), hacer transparente la propuesta de valor y costos, y ofrecer beneficios (lealtad, horas felices) para mejorar la ecuaci\u00f3n valor/precio."}, {"title": "Calidad y consistencia del producto", "detail": "Opiniones dispares: \u201cnormalito\u201d, \u201cperdi\u00f3 saz\u00f3n/industrializado\u201d, tigrillo \u201csopudo/ins\u00edpido\u201d, bol\u00f3n fr\u00edo o muy salado, uso de l\u00e1cteos excesivos o margarina vs otros que lo consideran excelente. Variabilidad entre locales.", "challenge": "Refinar y estandarizar recetas y procesos (temperatura, salado, grasas), auditor\u00edas sensoriales por local, KPIs de calidad en tiempo real y pilotos de receta \u201ccl\u00e1sico criollo\u201d vs \u201csello Tere\u201d para reconciliar expectativas."}, {"title": "Medios de pago", "detail": "Reclamo recurrente por no aceptar tarjetas/datafast; fricci\u00f3n de usar solo efectivo; algunos declaran no volver por esta raz\u00f3n.", "challenge": "Habilitar POS, QR y billeteras; comunicar razones y fechas de implementaci\u00f3n; incentivar pagos digitales con peque\u00f1os descuentos y reducir fuga de ventas."}, {"title": "Experiencia de servicio y operaci\u00f3n en sala", "detail": "Limpieza muy valorada; cr\u00edticas a autoservicio/recoger bandeja; colas; l\u00edmites de aj\u00ed por mesa; porciones percibidas como peque\u00f1as vs precio; confort (A/C) inconsistente.", "challenge": "Redise\u00f1ar flujos (se\u00f1al\u00e9tica, estaciones de bandejas), gestionar picos (pre-order/pick-up), revisar pol\u00edtica de porciones/extras/aj\u00ed, asegurar A/C y confort constantes."}, {"title": "Delivery y agregadores", "detail": "Molestia por m\u00ednimos a domicilio (p.ej. $17) y cuentas altas en apps con porciones peque\u00f1as.", "challenge": "Replantear m\u00ednimos por zona/hora, crear combos exclusivos de delivery y negociar comisiones con apps para sostener porci\u00f3n y precio percibido."}, {"title": "Gesti\u00f3n de reputaci\u00f3n y polarizaci\u00f3n social", "detail": "Conversaci\u00f3n masiva \u201clovers vs haters\u201d con connotaciones de clase (\u201cani\u00f1ado\u201d, \u201cresentido\u201d); al mismo tiempo orgullo por el caso de emprendimiento.", "challenge": "Social listening activo, protocolo de respuesta emp\u00e1tica, contenidos que celebren inclusi\u00f3n y trabajo, voceros cre\u00edbles y activaciones que desactiven antagonismos (catas abiertas, visitas a cocina)."}, {"+title": "Competencia y alternativas", "detail": "Se comparan frecuentemente con huecas y marcas (Aloha, Amorfino, Juan Tonga, mercados, Sauces, etc.) percibidas como m\u00e1s ricas o m\u00e1s baratas.", "challenge": "Benchmarking continuo, diferenciar por higiene, consistencia, conveniencia y experiencia; colaboraciones/ediciones limitadas y mejoras del aj\u00ed como firma."}, {"title": "Portafolio y desarrollo de producto", "detail": "Estrellas: bol\u00f3n mixto y tigrillo. El aj\u00ed es muy apreciado. Cr\u00edticas al caf\u00e9 (bebida) y peticiones por jugo de bistec/sabor m\u00e1s \u201ccriollo\u201d.", "challenge": "Ajustar tigrillo y caf\u00e9; ofrecer versiones \u201ctradicional\u201d y \u201cTere\u201d; ampliar opciones (light/veg), estandarizar el aj\u00ed y permitir recargas razonables."}, {"title": "Autenticidad culinaria vs estandarizaci\u00f3n", "detail": "Parte del p\u00fablico siente p\u00e9rdida de \u201cesencia\u201d por industrializaci\u00f3n y exceso de l\u00e1cteos; otros valoran la estandarizaci\u00f3n y limpieza.", "challenge": "Recuperar preparaciones patrimoniales y t\u00e9cnicas (p. ej., jugo de bistec), comunicar origen y proveedores locales y balancear autenticidad con consistencia."}, {"title": "Expansi\u00f3n y escalabilidad", "detail": "Alta demanda por abrir en Sierra/Exterior; preocupaci\u00f3n de que el crecimiento afecte el sabor; rumores de adquisiciones.", "challenge": "Modelo de expansi\u00f3n controlada (pilotos en Sierra), manuales operativos robustos, control de calidad centralizado y narrativa de crecimiento sin perder saz\u00f3n."}, {"title": "Arquitectura de marca y posicionamiento", "detail": "Confusi\u00f3n habitual entre \u201cCaf\u00e9 de Tere\u201d y \u201cBol\u00f3n de Tere\u201d; asociaci\u00f3n casi exclusiva a bol\u00f3n pese a un men\u00fa mayor.", "challenge": "Aclarar naming y ampliar el imaginario: campa\u00f1as que destaquen m\u00e1s categor\u00edas (tigrillo, muchines, jugos), y storytelling del origen para fortalecer identidad."}, {"title": "Educaci\u00f3n de mercado y pricing", "detail": "Debate sobre costos vs. precio, disposici\u00f3n a pagar por ambiente/servicio y definici\u00f3n del target (aspiracional vs. masivo).", "challenge": "Comunicar de forma did\u00e1ctica qu\u00e9 incluye el precio (higiene, salarios, impuestos), ofrecer escalones de entrada y segmentar ofertas por ocasi\u00f3n y canal."}, {"title": "Seguridad alimentaria y salud", "detail": "Casos aislados de malestar y percepciones de \u201cgrasoso\u201d; tambi\u00e9n menciones positivas de que \u201cno es muy grasoso\u201d.", "challenge": "Auditor\u00edas sanitarias visibles, mejoras en insumos (aceites/grasas), informaci\u00f3n nutricional b\u00e1sica y certificaciones exhibidas en sala y RRSS."}, {"title": "Ubicaci\u00f3n, acceso y conveniencia", "detail": "Atributos valorados: cercan\u00eda al aeropuerto, parqueo y seguridad; colas desincentivan; horarios influyen en elecci\u00f3n.", "challenge": "Optimizar capacidad en horas pico, habilitar pre-pago/pre-order, ventanillas express y se\u00f1alizar parqueos/horarios de menor espera."}, {"title": "Aprovechamiento de la viralidad", "detail": "Tendencias y memes generaron \u201cpublicidad gratis\u201d; percepci\u00f3n de que la marca no capitaliz\u00f3 del todo la ola.", "challenge": "Playbook de real time marketing, UGC, alianzas con creadores y activaciones tem\u00e1ticas cuando la marca sea tendencia; medici\u00f3n de lift y conversi\u00f3n."}], "conclusion": "La marca es ic\u00f3nica y altamente conversada, pero opera en un terreno polarizado donde el precio/valor, la consistencia del sabor, los medios de pago y la experiencia operativa generan fricci\u00f3n. Prioridades t\u00e1cticas: 1) habilitar pagos con tarjeta/QR, 2) recalibrar y estandarizar recetas (en especial tigrillo/bol\u00f3n) con control de temperatura y salado, 3) ajustar la propuesta de valor (porciones, combos y pol\u00edticas de delivery/aj\u00ed), 4) fortalecer el discurso de inclusi\u00f3n y emprendimiento con respuestas emp\u00e1ticas y 5) capitalizar la viralidad con activaciones y ofertas por canal. Ejecutar estas mejoras deber\u00eda elevar satisfacci\u00f3n, reducir la conversaci\u00f3n negativa y sostener el crecimiento sin sacrificar autenticidad."}};

    // Helper to format numbers
    const formatNumber = (num) => new Intl.NumberFormat('en-US').format(num);

    // --- 1. Populate Top Engaged Tweets Table ---
    function populateTopTweets() {
        const tableBody = document.querySelector('#top-tweets-table tbody');
        const engagement = data.engagement_matrix;

        // Combine data for easier sorting and filtering (only 10 are provided, so no sorting needed but good practice)
        const tweetKeys = Object.keys(engagement.total_engagement);
        const tweetData = tweetKeys.map(key => ({
            text: engagement.text[key],
            favorites: engagement.favorite_count[key],
            retweets: engagement.retweet_count[key],
            score: engagement.total_engagement[key]
        }));

        // Sort by score descending (though the input data seems to be roughly sorted)
        tweetData.sort((a, b) => b.score - a.score);

        tweetData.forEach(tweet => {
            const row = tableBody.insertRow();
            row.insertCell().textContent = tweet.text.length > 80 ? tweet.text.substring(0, 77) + '...' : tweet.text;
            row.insertCell().textContent = formatNumber(tweet.favorites);
            row.insertCell().textContent = formatNumber(tweet.retweets);
            row.insertCell().textContent = tweet.score.toFixed(2);
        });
    }

    // --- 2. Generate Engagement Heatmap Chart (Stacked Bar/Bar Chart Representation) ---
    function generateHeatmapChart() {
        const heatmapData = data.heatmap;
        const days = Object.keys(heatmapData);
        const hours = Array.from({length: 24}, (_, i) => i.toString()); // 0 to 23 hours

        const datasets = days.map((day, index) => {
            // Replace -1 with 0 for chart display and proper stacking
            const dayData = hours.map(hour => heatmapData[day][hour + '.0'] > 0 ? heatmapData[day][hour + '.0'] : 0);
            return {
                label: day,
                data: dayData,
                backgroundColor: getColor(index), // Assign a color from the palette
                borderColor: 'white',
                borderWidth: 1
            };
        });

        const ctx = document.getElementById('engagementHeatmapChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: hours.map(h => `${h}:00`),
                datasets: datasets
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Total Tweet Count by Hour and Day',
                        color: '#333'
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Hour of Day (24-Hour Format)',
                            color: '#333'
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Tweet Count',
                            color: '#333'
                        }
                    }
                }
            }
        });
    }

    // Color utility for charts
    function getColor(index) {
        const palette = ['#BDC730', '#5DA271', '#AED1B8', '#DEE398', '#333']; // Primary, Dark Accent, Accent, Secondary, Black
        return palette[index % palette.length];
    }
    
    // --- 3. Populate Topics and Challenges ---
    function populateTopics() {
        const topicsList = document.getElementById('topics-list');
        const topics = data.topics.topics;

        topics.forEach(topic => {
            const topicDiv = document.createElement('div');
            topicDiv.className = 'topic-item';

            const title = document.createElement('h3');
            title.textContent = topic.title;

            const detail = document.createElement('p');
            detail.innerHTML = `**Detail:** ${topic.detail}`;

            const challenge = document.createElement('p');
            challenge.innerHTML = `**Challenge:** ${topic.challenge}`;

            topicDiv.appendChild(title);
            topicDiv.appendChild(detail);
            topicDiv.appendChild(challenge);
            topicsList.appendChild(topicDiv);
        });
    }


    // --- Initialize Dashboard ---
    window.onload = () => {
        populateTopTweets();
        generateHeatmapChart();
        populateTopics();
    };
</script>

</body>
</html>